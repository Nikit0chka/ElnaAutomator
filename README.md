# ElnaAutomator

Автоматизатор для создания базовых функций и proc-сигналов. 

Эксплуатация:
1) При запуске приложения открывается окно выбора директории. Необходимо выбрать директорию, в которую будут генерироваться данные.
2) В приложении, во вкладке "Config", необходимо ввести исходные данные (сигналы, защиты, исполнительные механизмы).
3) Во вкладке "Data Types" есть возможность сгенерировать конфиги отдельно каждый.
4) Во вкладке "Functions" есть возможность сгенерировать функции отдельно каждую.
5) Во вкладке "Function Blocks" есть возможность сгенерировать функциональный блок отдельно каждый.
6) По нажатию на кнопку "GenerateAny" открывается окно с возможностью выбрать и сгенерировать несколько файлов.

Структура проекта:
Проект написан на .net7
1) Очень жаль того, кто подцепит этот проект под свое крыло, потому что по старту я решил, что проект небольшой и нет необходимости использовать MVVM, о чем очень жалею.
2) Все файлы логически распределены по директориям, всего их 5: Generators - классы, содержащие логику генерации; Pages - страницы; 
   FileOperations - классы для работы с записью в файл; Signals - классы, представляющие структуры сигналов, им, защит; Windows - окна.
3) Логика проекта построена на событийной модели - нажали на кнопку - что-то произошло.
4) Сигналы хранятся в классе App. По старту приложения из класса App вызывается логика выбора директории.
5) В проекте добавлена возможность сохранять и читать сигналы в файле "Config.txt" в формате json с помощью nuget-пакета "NewtonsoftJson".
   Он сохраняется по пути выбранной директории.
6) В классе App висит глобальный обработчик на необработанные исключения. В принципе, все ошибки, в основном при работе с файлами, выкидываются иерархически наверх.
7) Логика предложения пользователю сохранить конфиг висит в классе "MainWindow".
8) Генерация Excel-файлов с тегами реализована с помощью nuget-пакета "CsvHelper".
9) В проект добавлен костыль в виде класса "StringToNullableIntConverter.cs". По факту, в MVVM такая штука лежала бы в modelview, но пришлось ее кинуть отдельно.
   Класс используется для преобразования пустой строки из datagrid к nullable int типу.
10) В проекте есть очень печальный баг: при выборе di в любом из datagrid его не получится сбросить. 
     Функционалу не мешает (если выбран di, но не выбран бит к нему - генерация проходит успешно).